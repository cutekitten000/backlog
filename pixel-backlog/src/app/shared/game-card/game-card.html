<!-- src/app/shared/game-card/game-card.html -->

<div class="card-scroll">
  <div class="card-background" [style.background-image]="'url(' + game.coverUrl + ')'"></div>
  <div class="card-overlay"></div>

  <div class="card-content">
    <div class="card-actions">
      <button class="action-btn" (click)="details.emit()" title="Ver Detalhes e DLCs">
        <i class="material-symbols-outlined">more_horiz</i>
      </button>
      <button class="action-btn" (click)="edit.emit()" title="Editar Jogo">
        <i class="material-symbols-outlined">edit</i>
      </button>
      <button class="action-btn delete-btn" (click)="onDelete($event)" title="Apagar Jogo">
        <i class="material-symbols-outlined">delete</i>
      </button>
    </div>

    <div class="card-body">
      <span class="status-badge">{{ game.status }}</span>
      <h3 class="game-title">{{ game.title }}</h3>

      <div class="info-grid">
        @if (game.playtime) {
          <div class="info-item">
            <span class="info-label">Tempo</span>
            <span class="info-value">{{ game.playtime }}</span>
          </div>
        }
        @if (game.platforms.length) {
          <div class="info-item">
            <span class="info-label">Plataforma</span>
            <span class="info-value">{{ game.platforms.join(', ') }}</span>
          </div>
        }
      </div>

      <!-- NOVA SECÇÃO PARA A BARRA DE PROGRESSO DE CONQUISTAS -->
      @if (game.achievementsTotal && game.achievementsTotal > 0) {
        <div class="achievements-section">
          <p class="achievements-text">
            {{ game.achievementsGotten }} / {{ game.achievementsTotal }} conquistas
          </p>
          <div class="progress-bar">
            <div class="progress-bar-fill" [style.width.%]="achievementProgress"></div>
          </div>
        </div>
      }
    </div>

    <footer class="card-footer">
      @if (game.genres.length) {
        <div class="genre-tags">
          @for(genre of game.genres; track genre) {
            <span class="genre-tag">{{ genre }}</span>
          }
        </div>
      }
      <div class="trophy-icons">
        @if (game.isPlatinado) {
          <i class="material-symbols-outlined active" title="Platinado">military_tech</i>
        }
        @if (game.willPlatinar) {
          <i class="material-symbols-outlined" title="Vou Platinar">adjust</i>
        }
      </div>
    </footer>
  </div>
</div>